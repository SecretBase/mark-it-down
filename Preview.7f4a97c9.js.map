{"version":3,"sources":["../../src/comlink.ts","components/Preview/index.tsx","node_modules/parcel-bundler/src/builtins/bundle-url.js","node_modules/parcel-bundler/src/builtins/bundle-loader.js","node_modules/parcel-bundler/src/builtins/loaders/browser/js-loader.js"],"names":["bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","replace","exports","require","loadBundlesLazy","bundles","Array","isArray","id","length","Promise","resolve","code","LazyPromise","reject","loadBundles","slice","then","all","map","loadBundle","bundleLoaders","registerBundleLoader","type","loader","module","load","register","bundle","substring","lastIndexOf","toLowerCase","bundleLoader","resolved","catch","e","executor","promise","prototype","onSuccess","onError","script","document","createElement","async","charset","src","onerror","onload","getElementsByTagName","appendChild"],"mappings":"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","file":"Preview.7f4a97c9.js","sourceRoot":"..","sourcesContent":["/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Endpoint,\n  EventSource,\n  Message,\n  MessageType,\n  PostMessageWithOrigin,\n  WireValue,\n  WireValueType\n} from \"./protocol\";\nexport { Endpoint };\n\nexport const proxyMarker = Symbol(\"Comlink.proxy\");\nexport const createEndpoint = Symbol(\"Comlink.endpoint\");\nexport const releaseProxy = Symbol(\"Comlink.releaseProxy\");\nconst throwSet = new WeakSet();\n\n// prettier-ignore\ntype Promisify<T> =\n  T extends { [proxyMarker]: boolean }\n    ? Promise<Remote<T>>\n    : T extends (...args: infer R1) => infer R2\n        ? (...args: R1) => Promisify<R2>\n        : Promise<T>;\n\n// prettier-ignore\nexport type Remote<T> =\n  (\n    T extends (...args: infer R1) => infer R2\n      ? (...args: R1) => Promisify<R2>\n      : unknown\n  ) &\n  (\n    T extends { new (...args: infer R1): infer R2 }\n      ? { new (...args: R1): Promise<Remote<R2>> }\n      : unknown\n  ) &\n  (\n    T extends Object\n      ? { [K in keyof T]: Remote<T[K]> }\n      : unknown\n  ) &\n  (\n    T extends string\n      ? Promise<string>\n      : unknown\n  ) &\n  (\n    T extends number\n      ? Promise<number>\n      : unknown\n  ) &\n  (\n    T extends boolean\n      ? Promise<boolean>\n      : unknown\n  ) & {\n    [createEndpoint]: MessagePort;\n    [releaseProxy]: () => void;\n  };\n\ndeclare var x: Remote<number>;\n\ndeclare var y: PromiseLike<number>;\n\nexport interface TransferHandler {\n  canHandle(obj: any): boolean;\n  serialize(obj: any): [any, Transferable[]];\n  deserialize(obj: any): any;\n}\n\nexport const transferHandlers = new Map<string, TransferHandler>([\n  [\n    \"proxy\",\n    {\n      canHandle: obj => obj && obj[proxyMarker],\n      serialize(obj) {\n        const { port1, port2 } = new MessageChannel();\n        expose(obj, port1);\n        return [port2, [port2]];\n      },\n      deserialize: (port: MessagePort) => {\n        port.start();\n        return wrap(port);\n      }\n    }\n  ],\n  [\n    \"throw\",\n    {\n      canHandle: obj => throwSet.has(obj),\n      serialize(obj) {\n        const isError = obj instanceof Error;\n        let serialized = obj;\n        if (isError) {\n          serialized = {\n            isError,\n            message: obj.message,\n            stack: obj.stack\n          };\n        }\n        return [serialized, []];\n      },\n      deserialize(obj) {\n        if ((obj as any).isError) {\n          throw Object.assign(new Error(), obj);\n        }\n        throw obj;\n      }\n    }\n  ]\n]);\n\nexport function expose(obj: any, ep: Endpoint = self as any) {\n  ep.addEventListener(\"message\", function callback(ev: MessageEvent) {\n    if (!ev || !ev.data) {\n      return;\n    }\n    const { id, type, path } = {\n      path: [] as string[],\n      ...(ev.data as Message)\n    };\n    const argumentList = (ev.data.argumentList || []).map(fromWireValue);\n    let returnValue;\n    try {\n      const parent = path.slice(0, -1).reduce((obj, prop) => obj[prop], obj);\n      const rawValue = path.reduce((obj, prop) => obj[prop], obj);\n      switch (type) {\n        case MessageType.GET:\n          {\n            returnValue = rawValue;\n          }\n          break;\n        case MessageType.SET:\n          {\n            parent[path.slice(-1)[0]] = fromWireValue(ev.data.value);\n            returnValue = true;\n          }\n          break;\n        case MessageType.APPLY:\n          {\n            returnValue = rawValue.apply(parent, argumentList);\n          }\n          break;\n        case MessageType.CONSTRUCT:\n          {\n            const value = new rawValue(...argumentList);\n            returnValue = proxy(value);\n          }\n          break;\n        case MessageType.ENDPOINT:\n          {\n            const { port1, port2 } = new MessageChannel();\n            expose(obj, port2);\n            returnValue = transfer(port1, [port1]);\n          }\n          break;\n        case MessageType.RELEASE:\n          {\n            returnValue = undefined;\n          }\n          break;\n      }\n    } catch (e) {\n      returnValue = e;\n      throwSet.add(e);\n    }\n    Promise.resolve(returnValue)\n      .catch(e => {\n        throwSet.add(e);\n        return e;\n      })\n      .then(returnValue => {\n        const [wireValue, transferables] = toWireValue(returnValue);\n        ep.postMessage({ ...wireValue, id }, transferables);\n        if (type === MessageType.RELEASE) {\n          // detach and deactive after sending release response above.\n          ep.removeEventListener(\"message\", callback as any);\n          closeEndPoint(ep);\n        }\n      });\n  } as any);\n  if (ep.start) {\n    ep.start();\n  }\n}\n\nfunction isMessagePort(endpoint: Endpoint): endpoint is MessagePort {\n  return endpoint.constructor.name === \"MessagePort\";\n}\n\nfunction closeEndPoint(endpoint: Endpoint) {\n  if (isMessagePort(endpoint)) endpoint.close();\n}\n\nexport function wrap<T>(ep: Endpoint, target?: any): Remote<T> {\n  return createProxy<T>(ep, [], target) as any;\n}\n\nfunction throwIfProxyReleased(isReleased: boolean) {\n  if (isReleased) {\n    throw new Error(\"Proxy has been released and is not useable\");\n  }\n}\n\nfunction createProxy<T>(\n  ep: Endpoint,\n  path: (string | number | symbol)[] = [],\n  target: object = function() {}\n): Remote<T> {\n  let isProxyReleased = false;\n  const proxy = new Proxy(target, {\n    get(_target, prop) {\n      throwIfProxyReleased(isProxyReleased);\n      if (prop === releaseProxy) {\n        return () => {\n          return requestResponseMessage(ep, {\n            type: MessageType.RELEASE,\n            path: path.map(p => p.toString())\n          }).then(() => {\n            closeEndPoint(ep);\n            isProxyReleased = true;\n          });\n        };\n      }\n      if (prop === \"then\") {\n        if (path.length === 0) {\n          return { then: () => proxy };\n        }\n        const r = requestResponseMessage(ep, {\n          type: MessageType.GET,\n          path: path.map(p => p.toString())\n        }).then(fromWireValue);\n        return r.then.bind(r);\n      }\n      return createProxy(ep, [...path, prop]);\n    },\n    set(_target, prop, rawValue) {\n      throwIfProxyReleased(isProxyReleased);\n      // FIXME: ES6 Proxy Handler `set` methods are supposed to return a\n      // boolean. To show good will, we return true asynchronously ¯\\_(ツ)_/¯\n      const [value, transferables] = toWireValue(rawValue);\n      return requestResponseMessage(\n        ep,\n        {\n          type: MessageType.SET,\n          path: [...path, prop].map(p => p.toString()),\n          value\n        },\n        transferables\n      ).then(fromWireValue) as any;\n    },\n    apply(_target, _thisArg, rawArgumentList) {\n      throwIfProxyReleased(isProxyReleased);\n      const last = path[path.length - 1];\n      if ((last as any) === createEndpoint) {\n        return requestResponseMessage(ep, {\n          type: MessageType.ENDPOINT\n        }).then(fromWireValue);\n      }\n      // We just pretend that `bind()` didn’t happen.\n      if (last === \"bind\") {\n        return createProxy(ep, path.slice(0, -1));\n      }\n      const [argumentList, transferables] = processArguments(rawArgumentList);\n      return requestResponseMessage(\n        ep,\n        {\n          type: MessageType.APPLY,\n          path: path.map(p => p.toString()),\n          argumentList\n        },\n        transferables\n      ).then(fromWireValue);\n    },\n    construct(_target, rawArgumentList) {\n      throwIfProxyReleased(isProxyReleased);\n      const [argumentList, transferables] = processArguments(rawArgumentList);\n      return requestResponseMessage(\n        ep,\n        {\n          type: MessageType.CONSTRUCT,\n          path: path.map(p => p.toString()),\n          argumentList\n        },\n        transferables\n      ).then(fromWireValue);\n    }\n  });\n  return proxy as any;\n}\n\nfunction myFlat<T>(arr: (T | T[])[]): T[] {\n  return Array.prototype.concat.apply([], arr);\n}\n\nfunction processArguments(argumentList: any[]): [WireValue[], Transferable[]] {\n  const processed = argumentList.map(toWireValue);\n  return [processed.map(v => v[0]), myFlat(processed.map(v => v[1]))];\n}\n\nconst transferCache = new WeakMap<any, Transferable[]>();\nexport function transfer(obj: any, transfers: Transferable[]) {\n  transferCache.set(obj, transfers);\n  return obj;\n}\n\nexport function proxy<T>(obj: T): T & { [proxyMarker]: true } {\n  return Object.assign(obj, { [proxyMarker]: true }) as any;\n}\n\nexport function windowEndpoint(\n  w: PostMessageWithOrigin,\n  context: EventSource = self,\n  targetOrigin = \"*\"\n): Endpoint {\n  return {\n    postMessage: (msg: any, transferables: Transferable[]) =>\n      w.postMessage(msg, targetOrigin, transferables),\n    addEventListener: context.addEventListener.bind(context),\n    removeEventListener: context.removeEventListener.bind(context)\n  };\n}\n\nfunction toWireValue(value: any): [WireValue, Transferable[]] {\n  for (const [name, handler] of transferHandlers) {\n    if (handler.canHandle(value)) {\n      const [serializedValue, transferables] = handler.serialize(value);\n      return [\n        {\n          type: WireValueType.HANDLER,\n          name,\n          value: serializedValue\n        },\n        transferables\n      ];\n    }\n  }\n  return [\n    {\n      type: WireValueType.RAW,\n      value\n    },\n    transferCache.get(value) || []\n  ];\n}\n\nfunction fromWireValue(value: WireValue): any {\n  switch (value.type) {\n    case WireValueType.HANDLER:\n      return transferHandlers.get(value.name)!.deserialize(value.value);\n    case WireValueType.RAW:\n      return value.value;\n  }\n}\n\nfunction requestResponseMessage(\n  ep: Endpoint,\n  msg: Message,\n  transfers?: Transferable[]\n): Promise<WireValue> {\n  return new Promise(resolve => {\n    const id = generateUUID();\n    ep.addEventListener(\"message\", function l(ev: MessageEvent) {\n      if (!ev.data || !ev.data.id || ev.data.id !== id) {\n        return;\n      }\n      ep.removeEventListener(\"message\", l as any);\n      resolve(ev.data);\n    } as any);\n    if (ep.start) {\n      ep.start();\n    }\n    ep.postMessage({ id, ...msg }, transfers);\n  });\n}\n\nfunction generateUUID(): string {\n  return new Array(4)\n    .fill(0)\n    .map(() => Math.floor(Math.random() * Number.MAX_SAFE_INTEGER).toString(16))\n    .join(\"-\");\n}\n","import \"highlight.js/styles/github.css\"\nimport * as React from \"react\"\n\nimport { wrap } from \"comlink\"\nimport { Spinner } from \"react-bootstrap\"\n\nconst { useState, useEffect, memo } = React\nconst worker = new Worker(\"./markdownParser.ts\")\nconst fns = wrap<{ parse: parseFn }>(worker)\n\ninterface Props {\n  markdown: string\n}\n\ntype parseFn = (markdown: string) => string\n\nconst useMarkdown = (\n  markdown: string\n): { html: string; isLoading: boolean } => {\n  const [html, setHtml] = useState(\"\")\n  const [isLoading, setIsLoading] = useState(true)\n\n  useEffect(() => {\n    const run = async (): Promise<void> => {\n      const result = await fns.parse(markdown)\n      setHtml(result)\n      setIsLoading(false)\n    }\n    run()\n  }, [markdown])\n\n  return { html, isLoading }\n}\n\nconst Preview: React.FC<Props> = ({ markdown }) => {\n  const { html, isLoading } = useMarkdown(markdown)\n  if (isLoading)\n    return (\n      <Spinner animation=\"border\" role=\"status\">\n        <span className=\"sr-only\">Loading...</span>\n      </Spinner>\n    )\n\n  return <div dangerouslySetInnerHTML={{ __html: html }} />\n}\n\nexport default memo(Preview)\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var getBundleURL = require('./bundle-url').getBundleURL;\n\nfunction loadBundlesLazy(bundles) {\n  if (!Array.isArray(bundles)) {\n    bundles = [bundles]\n  }\n\n  var id = bundles[bundles.length - 1];\n\n  try {\n    return Promise.resolve(require(id));\n  } catch (err) {\n    if (err.code === 'MODULE_NOT_FOUND') {\n      return new LazyPromise(function (resolve, reject) {\n        loadBundles(bundles.slice(0, -1))\n          .then(function () {\n            return require(id);\n          })\n          .then(resolve, reject);\n      });\n    }\n\n    throw err;\n  }\n}\n\nfunction loadBundles(bundles) {\n  return Promise.all(bundles.map(loadBundle));\n}\n\nvar bundleLoaders = {};\nfunction registerBundleLoader(type, loader) {\n  bundleLoaders[type] = loader;\n}\n\nmodule.exports = exports = loadBundlesLazy;\nexports.load = loadBundles;\nexports.register = registerBundleLoader;\n\nvar bundles = {};\nfunction loadBundle(bundle) {\n  var id;\n  if (Array.isArray(bundle)) {\n    id = bundle[1];\n    bundle = bundle[0];\n  }\n\n  if (bundles[bundle]) {\n    return bundles[bundle];\n  }\n\n  var type = (bundle.substring(bundle.lastIndexOf('.') + 1, bundle.length) || bundle).toLowerCase();\n  var bundleLoader = bundleLoaders[type];\n  if (bundleLoader) {\n    return bundles[bundle] = bundleLoader(getBundleURL() + bundle)\n      .then(function (resolved) {\n        if (resolved) {\n          module.bundle.register(id, resolved);\n        }\n\n        return resolved;\n      }).catch(function(e) {\n        delete bundles[bundle];\n        \n        throw e;\n      });\n  }\n}\n\nfunction LazyPromise(executor) {\n  this.executor = executor;\n  this.promise = null;\n}\n\nLazyPromise.prototype.then = function (onSuccess, onError) {\n  if (this.promise === null) this.promise = new Promise(this.executor)\n  return this.promise.then(onSuccess, onError)\n};\n\nLazyPromise.prototype.catch = function (onError) {\n  if (this.promise === null) this.promise = new Promise(this.executor)\n  return this.promise.catch(onError)\n};\n","module.exports = function loadJSBundle(bundle) {\n  return new Promise(function (resolve, reject) {\n    var script = document.createElement('script');\n    script.async = true;\n    script.type = 'text/javascript';\n    script.charset = 'utf-8';\n    script.src = bundle;\n    script.onerror = function (e) {\n      script.onerror = script.onload = null;\n      reject(e);\n    };\n\n    script.onload = function () {\n      script.onerror = script.onload = null;\n      resolve();\n    };\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n  });\n};\n"]}